---
import { i18n, defaultLanguage } from '../config/i18n';

interface Props {
  title?: string;
  description?: string;
  ctaText?: string;
  ctaUrl?: string;
}

const { 
  title,
  description,
  ctaText,
  ctaUrl = '#contacto'
} = Astro.props;

const lang = defaultLanguage;
const texts = i18n[lang];
const heroTitle = title || texts.hero.title;
const heroDesc = description || texts.hero.description;
const heroCTA = ctaText || texts.hero.cta;

// Split title into lines for translation
const titleLines = heroTitle.split('experiencia digital');
---

<section
  class="relative min-h-screen flex items-center justify-center pt-16 overflow-hidden hero-gradient"
  aria-label="Sección principal"
  data-i18n="hero"
>
  {/* Decorative elements */}
  <div class="absolute inset-0 overflow-hidden">
    <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl" />
    <div class="absolute bottom-1/4 right-1/4 w-64 h-64 bg-primary/10 rounded-full blur-3xl" />
  </div>

  <div class="container relative z-10">
    <div class="max-w-4xl mx-auto text-center">
      {/* Badge */}
      <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full border border-border bg-secondary/50 mb-8 animate-fade-up opacity-0" role="status" aria-live="polite">
        <span aria-hidden="true" class="text-primary text-base">✨</span>
        <span class="text-sm text-muted-foreground hero-badge">{texts.hero.badge}</span>
      </div>

      {/* Main headline */}
      <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold tracking-tight mb-6 animate-fade-up opacity-0 stagger-1 leading-tight hero-title text-foreground">
        <span class="block">{titleLines[0]}</span>
        <span class="block text-primary">experiencia digital</span>
        <span class="block">{titleLines[1] || ''}</span>
      </h1>

      {/* Subtitle */}
      <p class="text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mb-10 animate-fade-up opacity-0 stagger-2 hero-description">
        {heroDesc}
      </p>

      {/* CTAs */}
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 animate-fade-up opacity-0 stagger-3">
        <a 
          href={ctaUrl} 
          class="glow group px-8 py-3 inline-flex items-center gap-2 w-full sm:w-auto justify-center text-base font-medium bg-primary text-primary-foreground rounded-lg transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background focus:ring-primary active:scale-95 hero-cta"
          aria-label={heroCTA}
        >
          {heroCTA}
          <span aria-hidden="true" class="group-hover:translate-x-1 transition-transform">→</span>
        </a>
        <a 
          href="#servicios" 
          class="px-8 py-3 inline-flex items-center w-full sm:w-auto justify-center text-base font-medium border border-border/50 bg-secondary/50 text-foreground hover:bg-secondary rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background focus:ring-primary active:scale-95"
          aria-label={texts.hero.secondary}
        >
          {texts.hero.secondary}
        </a>
      </div>

      {/* Trust indicators */}
      <div class="mt-16 pt-16 border-t border-border/50 animate-fade-up opacity-0 stagger-4">
        <p class="text-sm text-muted-foreground mb-6 hero-companies-label">{texts.hero.companies}</p>
        <div class="flex flex-wrap items-center justify-center gap-8 md:gap-12 opacity-50" role="list" aria-label="Empresas clientes">
          {["TechStart", "GrowthCo", "Innovate", "NextLevel", "BuildIt"].map((company) => (
            <span class="text-lg font-semibold text-muted-foreground/70 whitespace-nowrap" role="listitem">
              {company}
            </span>
          ))}
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { i18n } from '../config/i18n';
  
  function updateHeroTexts() {
    const lang = (document.documentElement.dataset.lang as keyof typeof i18n) || 'es';
    const texts = i18n[lang];
    
    const badgeEl = document.querySelector('.hero-badge');
    if (badgeEl) badgeEl.textContent = texts.hero.badge;
    
    const companiesLabelEl = document.querySelector('.hero-companies-label');
    if (companiesLabelEl) companiesLabelEl.textContent = texts.hero.companies;
    
    const titleEl = document.querySelector('.hero-title');
    if (titleEl) {
      const titleLines = texts.hero.title.split('experiencia digital');
      const spans = titleEl.querySelectorAll('span');
      if (spans.length >= 3) {
        spans[0].textContent = titleLines[0] || '';
        spans[1].textContent = 'experiencia digital';
        spans[2].textContent = titleLines[1] || '';
      }
    }
    
    const descEl = document.querySelector('.hero-description');
    if (descEl) descEl.textContent = texts.hero.description;
    
    const ctaEl = document.querySelector('.hero-cta');
    if (ctaEl) {
      ctaEl.textContent = texts.hero.cta + ' →';
      ctaEl.setAttribute('aria-label', texts.hero.cta);
    }
    
    const secondaryCta = document.querySelector('a[aria-label]') as HTMLAnchorElement;
    if (secondaryCta && secondaryCta.getAttribute('aria-label') !== texts.hero.cta) {
      secondaryCta.textContent = texts.hero.secondary;
      secondaryCta.setAttribute('aria-label', texts.hero.secondary);
    }
  }
  
  document.addEventListener('languageChanged', updateHeroTexts);
</script>
