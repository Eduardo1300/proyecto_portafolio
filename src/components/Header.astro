---
import { i18n, defaultLanguage } from '../config/i18n';
import LanguageSwitcher from './LanguageSwitcher.astro';

const lang = defaultLanguage;
const texts = i18n[lang];
---

<header class="fixed top-0 left-0 right-0 z-50 border-b border-border/50 bg-background/80 backdrop-blur-xl" role="banner">
  <div class="container flex h-16 items-center justify-between">
    {/* Logo */}
<a href="/" class="text-xl font-bold tracking-tight text-foreground focus:outline-none focus:ring-2 focus:ring-primary rounded px-2" aria-label="Christopher Valdivia - Inicio">
      Christopher Valdivia
    </a>

    {/* Navigation */}
    <nav class="hidden md:flex items-center gap-8" aria-label="Navegación principal">
      <a href="#servicios" class="text-sm text-muted-foreground hover:text-foreground transition-colors focus:outline-none focus:ring-2 focus:ring-primary rounded px-2 py-1 nav-servicios" aria-current="false">
        {texts.nav.servicios}
      </a>
      <a href="#proceso" class="text-sm text-muted-foreground hover:text-foreground transition-colors focus:outline-none focus:ring-2 focus:ring-primary rounded px-2 py-1 nav-proceso">
        {texts.nav.proceso}
      </a>
      <a href="#beneficios" class="text-sm text-muted-foreground hover:text-foreground transition-colors focus:outline-none focus:ring-2 focus:ring-primary rounded px-2 py-1 nav-beneficios">
        {texts.nav.beneficios}
      </a>
      <a href="#faq" class="text-sm text-muted-foreground hover:text-foreground transition-colors focus:outline-none focus:ring-2 focus:ring-primary rounded px-2 py-1 nav-faq">
        {texts.nav.faq}
      </a>
    </nav>

{/* Contact Button & Language Switcher */}
    <div class="flex items-center gap-4">
      <LanguageSwitcher currentLang={lang} />
      <a
        href="#contacto"
        class="glow px-6 py-2 text-sm font-medium bg-primary text-primary-foreground rounded-lg transition-all hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background focus:ring-primary nav-contacto"
      >
        {texts.nav.contacto}
      </a>
    </div>

    {/* Mobile menu button */}
    <button 
      class="md:hidden text-foreground text-xl p-2 focus:outline-none focus:ring-2 focus:ring-primary rounded" 
      id="mobile-menu"
      aria-label="Abrir menú"
      aria-expanded="false"
      aria-controls="mobile-nav"
    >
      ☰
    </button>
  </div>

  {/* Mobile menu */}
  <nav
    id="mobile-nav"
    class="hidden md:hidden border-t border-border/50 bg-background/95 backdrop-blur"
    aria-label="Navegación móvil"
  >
    <div class="container px-0 py-4 space-y-2">
      <a
        href="#servicios"
        class="block text-sm text-muted-foreground hover:text-foreground py-2 px-4 focus:outline-none focus:ring-2 focus:ring-primary rounded transition-colors nav-servicios-mobile"
      >
        {texts.nav.servicios}
      </a>
      <a
        href="#proceso"
        class="block text-sm text-muted-foreground hover:text-foreground py-2 px-4 focus:outline-none focus:ring-2 focus:ring-primary rounded transition-colors nav-proceso-mobile"
      >
        {texts.nav.proceso}
      </a>
      <a
        href="#beneficios"
        class="block text-sm text-muted-foreground hover:text-foreground py-2 px-4 focus:outline-none focus:ring-2 focus:ring-primary rounded transition-colors nav-beneficios-mobile"
      >
        {texts.nav.beneficios}
      </a>
      <a
        href="#faq"
        class="block text-sm text-muted-foreground hover:text-foreground py-2 px-4 focus:outline-none focus:ring-2 focus:ring-primary rounded transition-colors nav-faq-mobile"
      >
        {texts.nav.faq}
      </a>
<a
        href="#contacto"
        class="block glow w-full mx-4 px-4 py-2.5 text-center text-sm font-medium bg-primary text-primary-foreground rounded-lg transition-all hover:shadow-lg nav-contacto-mobile"
      >
        {texts.nav.contacto}
      </a>
      
      {/* Language Switcher Mobile */}
      <div class="flex justify-center pt-4 border-t border-border/50 mt-4">
        <LanguageSwitcher currentLang={lang} />
      </div>
    </div>
  </nav>
</header>

<script>
  const mobileMenuBtn = document.getElementById('mobile-menu');
  const mobileNav = document.getElementById('mobile-nav');

  if (mobileMenuBtn && mobileNav) {
    mobileMenuBtn.addEventListener('click', () => {
      const isOpen = !mobileNav.classList.contains('hidden');
      mobileNav.classList.toggle('hidden');
      mobileMenuBtn.setAttribute('aria-expanded', isOpen ? 'false' : 'true');
    });

    const links = mobileNav.querySelectorAll('a');
    links.forEach((link) => {
      link.addEventListener('click', () => {
        mobileNav.classList.add('hidden');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
      });
    });
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !mobileNav.classList.contains('hidden')) {
        mobileNav.classList.add('hidden');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
        mobileMenuBtn.focus();
      }
    });
  }

  import { i18n } from '../config/i18n';
  
  function updateNavTexts() {
    const lang = (document.documentElement.dataset.lang as keyof typeof i18n) || 'es';
    const texts = i18n[lang];
    
    document.querySelector('.nav-servicios')!.textContent = texts.nav.servicios;
    document.querySelector('.nav-proceso')!.textContent = texts.nav.proceso;
    document.querySelector('.nav-beneficios')!.textContent = texts.nav.beneficios;
    document.querySelector('.nav-faq')!.textContent = texts.nav.faq;
    document.querySelector('.nav-contacto')!.textContent = texts.nav.contacto;
    
    document.querySelector('.nav-servicios-mobile')!.textContent = texts.nav.servicios;
    document.querySelector('.nav-proceso-mobile')!.textContent = texts.nav.proceso;
    document.querySelector('.nav-beneficios-mobile')!.textContent = texts.nav.beneficios;
    document.querySelector('.nav-faq-mobile')!.textContent = texts.nav.faq;
    document.querySelector('.nav-contacto-mobile')!.textContent = texts.nav.contacto;
  }
  
  document.addEventListener('languageChanged', updateNavTexts);
</script>
